# Open WebUI å¼€å‘æµç¨‹æŒ‡å—

## ğŸ“‹ å¼€å‘æµç¨‹æ¦‚è§ˆ

```
1. ç¯å¢ƒå‡†å¤‡ âœ…
   â”œâ”€ Python 3.11.x (conda smart-work)
   â”œâ”€ Node.js 18-22 (éœ€è¦è§£å†³ç‰ˆæœ¬é—®é¢˜)
   â””â”€ .env é…ç½®æ–‡ä»¶ âœ…

2. å®‰è£…ä¾èµ–
   â”œâ”€ åç«¯ä¾èµ– (pip install -e .)
   â””â”€ å‰ç«¯ä¾èµ– (npm install)

3. å¯åŠ¨æœåŠ¡
   â”œâ”€ åç«¯ (ç«¯å£ 8080)
   â””â”€ å‰ç«¯ (ç«¯å£ 5173)

4. å¼€å§‹å¼€å‘
   â”œâ”€ ä»£ç ä¿®æ”¹
   â”œâ”€ è‡ªåŠ¨é‡è½½
   â””â”€ æµ‹è¯•éªŒè¯
```

## ğŸš€ å®Œæ•´å¼€å‘æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒæ£€æŸ¥

```bash
# 1. æ£€æŸ¥ Python ç¯å¢ƒ
conda activate smart-work
python --version  # åº”è¯¥æ˜¯ 3.11.x

# 2. æ£€æŸ¥ .env æ–‡ä»¶
cd /home/sai/open-webui
cat .env  # ç¡®è®¤ ModelScope é…ç½®å­˜åœ¨

# 3. æ£€æŸ¥ Node.js âœ… å·²è§£å†³
node --version  # âœ… ç°åœ¨æ˜¯ v22.21.1ï¼ˆä½¿ç”¨ nvm ç®¡ç†ï¼‰
```

### ç¬¬äºŒæ­¥ï¼šå®‰è£…åç«¯ä¾èµ– âš ï¸ å¾…å®Œæˆ

```bash
cd /home/sai/open-webui
conda activate smart-work

# æ–¹å¼ä¸€ï¼šå¼€å‘æ¨¡å¼å®‰è£…ï¼ˆæ¨èï¼Œä»£ç ä¿®æ”¹åè‡ªåŠ¨ç”Ÿæ•ˆï¼‰
pip install -e .

# æ–¹å¼äºŒï¼šä»…å®‰è£…ä¾èµ–ï¼ˆä¸æ¨èç”¨äºå¼€å‘ï¼‰
cd backend
pip install -r requirements.txt
```

**éªŒè¯å®‰è£…**ï¼š
```bash
conda activate smart-work
python -c "import open_webui; print('âœ… åç«¯ä¾èµ–å®‰è£…æˆåŠŸ')"
```

### ç¬¬ä¸‰æ­¥ï¼šè§£å†³ Node.js ç‰ˆæœ¬é—®é¢˜ âœ… å·²å®Œæˆ

âœ… **å·²å®‰è£… nvm å’Œ Node.js 22**
- nvm ç‰ˆæœ¬: 0.40.3
- Node.js ç‰ˆæœ¬: v22.21.1
- npm ç‰ˆæœ¬: 10.9.4
- ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿå®‰è£…

**æ¯æ¬¡ä½¿ç”¨å‰åŠ è½½ nvm**ï¼š
```bash
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
nvm use 22
```

### ç¬¬å››æ­¥ï¼šå®‰è£…å‰ç«¯ä¾èµ– âœ… å·²å®Œæˆ

âœ… **å‰ç«¯ä¾èµ–å·²å®‰è£…å®Œæˆ**
- ä½¿ç”¨ npm å›½å†…é•œåƒï¼ˆregistry.npmmirror.comï¼‰
- ä½¿ç”¨ --legacy-peer-deps è§£å†³ç‰ˆæœ¬å†²çª
- Pyodide ä¾èµ–å·²ä¸‹è½½

### ç¬¬äº”æ­¥ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨

#### å¯åŠ¨åç«¯ï¼ˆç»ˆç«¯ 1ï¼‰

```bash
cd /home/sai/open-webui
conda activate smart-work

# æ–¹å¼ä¸€ï¼šä½¿ç”¨ open-webui dev å‘½ä»¤ï¼ˆæ¨èï¼‰
open-webui dev

# æ–¹å¼äºŒï¼šä½¿ç”¨ dev.sh è„šæœ¬
cd backend
bash dev.sh

# æ–¹å¼ä¸‰ï¼šç›´æ¥ä½¿ç”¨ uvicorn
cd backend
export CORS_ALLOW_ORIGIN="http://localhost:5173;http://localhost:8080"
uvicorn open_webui.main:app --port 8080 --host 0.0.0.0 --forwarded-allow-ips '*' --reload
```

**åç«¯å°†åœ¨**: `http://localhost:8080` å¯åŠ¨  
**ç‰¹æ€§**: è‡ªåŠ¨é‡è½½ï¼ˆä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡å¯ï¼‰

#### å¯åŠ¨å‰ç«¯ï¼ˆç»ˆç«¯ 2ï¼‰

```bash
cd /home/sai/open-webui

# ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Node.js ç‰ˆæœ¬
nvm use 22  # å¦‚æœå®‰è£…äº† nvm

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

**å‰ç«¯å°†åœ¨**: `http://localhost:5173` å¯åŠ¨  
**ç‰¹æ€§**: çƒ­é‡è½½ï¼ˆä»£ç ä¿®æ”¹åè‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ï¼‰

### ç¬¬å…­æ­¥ï¼šè®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š**http://localhost:5173**

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### æ—¥å¸¸å¼€å‘æµç¨‹

1. **å¯åŠ¨æœåŠ¡**
   ```bash
   # ç»ˆç«¯ 1ï¼šåç«¯
   conda activate smart-work
   cd /home/sai/open-webui
   open-webui dev
   
   # ç»ˆç«¯ 2ï¼šå‰ç«¯
   cd /home/sai/open-webui
   npm run dev
   ```

2. **ä¿®æ”¹ä»£ç **
   - åç«¯ä»£ç ï¼šä¿®æ”¹ `backend/open_webui/` ä¸‹çš„æ–‡ä»¶
   - å‰ç«¯ä»£ç ï¼šä¿®æ”¹ `src/` ä¸‹çš„æ–‡ä»¶
   - é…ç½®ï¼šä¿®æ”¹ `backend/open_webui/config.py` æˆ– `.env`

3. **æŸ¥çœ‹å˜åŒ–**
   - åç«¯ï¼šè‡ªåŠ¨é‡å¯ï¼ˆæŸ¥çœ‹ç»ˆç«¯ 1 çš„è¾“å‡ºï¼‰
   - å‰ç«¯ï¼šæµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°ï¼ˆæŸ¥çœ‹ç»ˆç«¯ 2 çš„è¾“å‡ºï¼‰

4. **æµ‹è¯•åŠŸèƒ½**
   - åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•æ–°åŠŸèƒ½
   - æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£ API è°ƒç”¨æƒ…å†µ

### ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–

#### å‰ç«¯ä»£ç 

```bash
# ä»£ç æ£€æŸ¥
npm run check

# ä»£ç æ ¼å¼åŒ–
npm run format

# Lint æ£€æŸ¥
npm run lint:frontend
```

#### åç«¯ä»£ç 

```bash
conda activate smart-work
cd /home/sai/open-webui

# ä»£ç æ ¼å¼åŒ–ï¼ˆBlackï¼‰
npm run format:backend
# æˆ–
black backend/

# Lint æ£€æŸ¥
npm run lint:backend
# æˆ–
pylint backend/
```

### è°ƒè¯•æŠ€å·§

#### åç«¯è°ƒè¯•

1. **æŸ¥çœ‹æ—¥å¿—**
   - åç«¯ç»ˆç«¯ä¼šæ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—
   - ä½¿ç”¨ `loguru` è®°å½•æ—¥å¿—

2. **API æ–‡æ¡£**
   - å¼€å‘æ¨¡å¼ä¸‹è®¿é—®ï¼š`http://localhost:8080/docs`
   - æŸ¥çœ‹æ‰€æœ‰ API ç«¯ç‚¹å’Œæµ‹è¯•æ¥å£

3. **æ–­ç‚¹è°ƒè¯•**
   ```python
   # åœ¨ä»£ç ä¸­æ·»åŠ æ–­ç‚¹
   import pdb; pdb.set_trace()
   ```

#### å‰ç«¯è°ƒè¯•

1. **æµè§ˆå™¨å¼€å‘è€…å·¥å…·**
   - F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹ Consoleã€Networkã€Application ç­‰

2. **Vite å¼€å‘å·¥å…·**
   - è®¿é—® `http://localhost:5173`
   - æŸ¥çœ‹ Vite çš„ HMRï¼ˆçƒ­æ¨¡å—æ›¿æ¢ï¼‰çŠ¶æ€

## ğŸ“ é¡¹ç›®ç»“æ„

```
open-webui/
â”œâ”€â”€ backend/              # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ open_webui/      # ä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ main.py      # FastAPI åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.py    # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ routers/     # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/      # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ requirements.txt # Python ä¾èµ–
â”œâ”€â”€ src/                 # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ lib/             # åº“æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ components/ # Svelte ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ stores/     # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ apis/       # API å®¢æˆ·ç«¯
â”‚   â””â”€â”€ routes/          # è·¯ç”±é¡µé¢
â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡é…ç½® âœ…
â””â”€â”€ package.json         # å‰ç«¯ä¾èµ–é…ç½®
```

## ğŸ¯ å¸¸ç”¨å¼€å‘ä»»åŠ¡

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

1. åœ¨ `backend/open_webui/routers/` åˆ›å»ºæˆ–ä¿®æ”¹è·¯ç”±æ–‡ä»¶
2. åœ¨ `backend/open_webui/main.py` ä¸­æ³¨å†Œè·¯ç”±
3. é‡å¯åç«¯ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
4. åœ¨ `http://localhost:8080/docs` æµ‹è¯•

### æ·»åŠ æ–°çš„å‰ç«¯ç»„ä»¶

1. åœ¨ `src/lib/components/` åˆ›å»ºç»„ä»¶
2. åœ¨éœ€è¦çš„åœ°æ–¹å¯¼å…¥ä½¿ç”¨
3. æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°æŸ¥çœ‹æ•ˆæœ

### ä¿®æ”¹é…ç½®

1. **ç¯å¢ƒå˜é‡**ï¼šä¿®æ”¹ `.env` æ–‡ä»¶
2. **åº”ç”¨é…ç½®**ï¼šä¿®æ”¹ `backend/open_webui/config.py`
3. é‡å¯åç«¯æœåŠ¡

### æ•°æ®åº“è¿ç§»

```bash
conda activate smart-work
cd /home/sai/open-webui/backend

# åˆ›å»ºè¿ç§»
alembic revision --autogenerate -m "æè¿°"

# åº”ç”¨è¿ç§»
alembic upgrade head
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. åç«¯æ— æ³•å¯åŠ¨

**æ£€æŸ¥**ï¼š
- Python ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼ˆ3.11.xï¼‰
- ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´
- `.env` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- ç«¯å£ 8080 æ˜¯å¦è¢«å ç”¨

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080

# é‡æ–°å®‰è£…ä¾èµ–
conda activate smart-work
pip install -e . --force-reinstall
```

### 2. å‰ç«¯æ— æ³•å¯åŠ¨

**æ£€æŸ¥**ï¼š
- Node.js ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ï¼ˆ18-22ï¼‰
- ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´
- ç«¯å£ 5173 æ˜¯å¦è¢«å ç”¨

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :5173

# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install --legacy-peer-deps
```

### 3. å‰åç«¯æ— æ³•é€šä¿¡

**æ£€æŸ¥**ï¼š
- åç«¯æ˜¯å¦åœ¨è¿è¡Œï¼ˆ`http://localhost:8080`ï¼‰
- CORS é…ç½®æ˜¯å¦æ­£ç¡®
- æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

**è§£å†³**ï¼š
- ç¡®ä¿åç«¯å·²å¯åŠ¨
- æ£€æŸ¥ `backend/dev.sh` ä¸­çš„ CORS é…ç½®

### 4. æ¨¡å‹ API è°ƒç”¨å¤±è´¥

**æ£€æŸ¥**ï¼š
- `.env` æ–‡ä»¶ä¸­çš„ API é…ç½®
- ModelScope API æ˜¯å¦å¯è®¿é—®
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

**è§£å†³**ï¼š
```bash
# æµ‹è¯• API è¿æ¥
curl -X POST https://api-inference.modelscope.cn/v1/models \
  -H "Authorization: Bearer ms-30c52a2c-5f77-4d20-9604-a6d9a6bed1cb"
```

## ğŸ“ å¼€å‘æ£€æŸ¥æ¸…å•

### é¦–æ¬¡è®¾ç½®

- [ ] Python 3.11.x ç¯å¢ƒå·²æ¿€æ´»
- [ ] `.env` æ–‡ä»¶å·²åˆ›å»ºå¹¶é…ç½®
- [ ] åç«¯ä¾èµ–å·²å®‰è£…ï¼ˆ`pip install -e .`ï¼‰
- [ ] Node.js ç‰ˆæœ¬å·²è§£å†³ï¼ˆ18-22ï¼‰
- [ ] å‰ç«¯ä¾èµ–å·²å®‰è£…ï¼ˆ`npm install`ï¼‰

### æ¯æ¬¡å¼€å‘

- [ ] åç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆ`open-webui dev`ï¼‰
- [ ] å‰ç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆ`npm run dev`ï¼‰
- [ ] æµè§ˆå™¨å·²æ‰“å¼€ `http://localhost:5173`
- [ ] ä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡è½½æ­£å¸¸

## ğŸš€ å¿«é€Ÿå¯åŠ¨è„šæœ¬

åˆ›å»º `start-dev.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash

# å¯åŠ¨åç«¯
echo "å¯åŠ¨åç«¯æœåŠ¡..."
cd /home/sai/open-webui
conda activate smart-work
open-webui dev &
BACKEND_PID=$!

# ç­‰å¾…åç«¯å¯åŠ¨
sleep 3

# å¯åŠ¨å‰ç«¯
echo "å¯åŠ¨å‰ç«¯æœåŠ¡..."
cd /home/sai/open-webui
npm run dev &
FRONTEND_PID=$!

echo "åç«¯ PID: $BACKEND_PID"
echo "å‰ç«¯ PID: $FRONTEND_PID"
echo "åç«¯: http://localhost:8080"
echo "å‰ç«¯: http://localhost:5173"
echo ""
echo "æŒ‰ Ctrl+C åœæ­¢æœåŠ¡"

# ç­‰å¾…ä¸­æ–­
wait
```

ä½¿ç”¨ï¼š
```bash
chmod +x start-dev.sh
./start-dev.sh
```

## ğŸ“š å‚è€ƒèµ„æº

- **API æ–‡æ¡£**ï¼š`http://localhost:8080/docs`ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
- **é¡¹ç›®æ–‡æ¡£**ï¼š`/home/sai/open-webui/æŠ€æœ¯æ–‡æ¡£.md`
- **é…ç½®æŒ‡å—**ï¼š`/home/sai/open-webui/ModelScopeé…ç½®æŒ‡å—.md`
- **ç¯å¢ƒé…ç½®**ï¼š`/home/sai/open-webui/Condaç¯å¢ƒé…ç½®æŒ‡å—.md`

---

**å¼€å§‹å¼€å‘**ï¼šæŒ‰ç…§ä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨ç°åœ¨å¯ä»¥å¼€å§‹å¼€å‘äº†ï¼ğŸ‰

